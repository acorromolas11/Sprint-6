/*Primera Problematica*/

/*Tipo De Cliente*/
CREATE TABLE tipo_cliente(
				tipo_id INTEGER PRIMARY KEY,
				tipo_name TEXT NOT NULL
				);

INSERT INTO tipo_cliente (tipo_name)
VALUES ('Classic'), ('Gold'), ('Black');

SELECT *
FROM tipo_cliente;				

/*Tipo De Cuenta*/
CREATE TABLE tipo_cuenta(
				cuenta_id INTEGER PRIMARY KEY,
				cuenta_name TEXT NOT NULL,
				moneda TEXT NOT NULL
				);

INSERT INTO tipo_cuenta (cuenta_name,moneda)
VALUES ('Caja de ahorro','Pesos'),('Caja de ahorro','Dolares'),('Cuenta corriente','Pesos'), ('Cuenta corriente','Dolares');

SELECT *
FROM tipo_cuenta;			

/*Marcas de tarjetas*/
CREATE TABLE marca_tarjeta(
				tarjeta_id INTEGER PRIMARY KEY,
				tarjeta_name TEXT NOT NULL
				);
				
INSERT INTO marca_tarjeta (tarjeta_name)
VALUES ('VISA'), ('MASTER'), ('AMEX');

SELECT *
FROM marca_tarjeta	

/*Agregado entidad tarjeta*/ /*Relacionado de tarjetas con la tabla donde se guardan las marcas de tarjeta y con el cliente al que pertenecen*/

CREATE TABLE tarjeta( 
				numero INTEGER PRIMARY KEY UNIQUE CHECK(length(numero) <= 20),
				cvv INTEGER UNIQUE,
				fecha_de_otorgamiento INTEGER DEFAULT '02/22',
				fecha_de_expiracion INTEGER DEFAULT '08/27',
				tipo_tarjeta INTEGER DEFAULT 'Credito',
				tarjeta_id INTEGER,
				customer_id INTEGER UNIQUE,
				FOREIGN KEY (customer_id)
				REFERENCES cliente (customer_id)
				FOREIGN KEY (tarjeta_id)
				REFERENCES marca_tarjeta (tarjeta_id)
				);
				
/*Agregar 500 tarjetas de credito*/ /*Primera parte*/
INSERT INTO tarjeta (numero, cvv, tarjeta_id, customer_id)
VALUES ('6545123547895245',163,1,1);

/*Agregar 500 tarjetas de credito*/ /*segunda parte*/
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (164,2,2),
  (165,3,3),
  (166,3,4),
  (167,2,5),
  (168,2,6),
  (169,3,7),
  (170,2,8),
  (171,1,9),
  (172,2,10),
  (173,2,11),
  (174,2,12),
  (175,2,13),
  (176,2,14),
  (177,2,15),
  (178,2,16),
  (179,2,17),
  (180,2,18),
  (181,1,19),
  (182,2,20),
  (183,3,21),
  (184,2,22),
  (185,3,23),
  (186,2,24),
  (187,1,25),
  (188,1,26),
  (189,3,27),
  (190,1,28),
  (191,1,29),
  (192,1,30),
  (193,1,31),
  (194,2,32),
  (195,2,33),
  (196,1,34),
  (197,3,35),
  (198,2,36),
  (199,1,37),
  (200,2,38),
  (201,2,39),
  (202,2,40),
  (203,2,41),
  (204,2,42),
  (205,3,43),
  (206,2,44),
  (207,2,45),
  (208,3,46),
  (209,2,47),
  (210,1,48),
  (211,2,49),
  (212,2,50),
  (213,2,51);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (214,3,52),
  (215,1,53),
  (216,1,54),
  (217,2,55),
  (218,2,56),
  (219,3,57),
  (220,2,58),
  (221,2,59),
  (222,2,60),
  (223,3,61),
  (224,1,62),
  (225,1,63),
  (226,2,64),
  (227,2,65),
  (228,1,66),
  (229,3,67),
  (230,2,68),
  (231,3,69),
  (232,1,70),
  (233,1,71),
  (234,2,72),
  (235,2,73),
  (236,3,74),
  (237,2,75),
  (238,1,76),
  (239,1,77),
  (240,1,78),
  (241,1,79),
  (242,3,80),
  (243,3,81),
  (244,2,82),
  (245,2,83),
  (246,2,84),
  (247,2,85),
  (248,2,86),
  (249,1,87),
  (250,2,88),
  (251,1,89),
  (252,2,90),
  (253,2,91),
  (254,3,92),
  (255,2,93),
  (256,2,94),
  (257,3,95),
  (258,1,96),
  (259,1,97),
  (260,2,98),
  (261,3,99),
  (262,3,100),
  (263,2,101);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (264,2,102),
  (265,2,103),
  (266,1,104),
  (267,2,105),
  (268,2,106),
  (269,3,107),
  (270,2,108),
  (271,2,109),
  (272,3,110),
  (273,2,111),
  (274,3,112),
  (275,1,113),
  (276,1,114),
  (277,2,115),
  (278,3,116),
  (279,1,117),
  (280,3,118),
  (281,2,119),
  (282,2,120),
  (283,2,121),
  (284,2,122),
  (285,3,123),
  (286,3,124),
  (287,3,125),
  (288,3,126),
  (289,1,127),
  (290,2,128),
  (291,3,129),
  (292,2,130),
  (293,2,131),
  (294,1,132),
  (295,2,133),
  (296,1,134),
  (297,3,135),
  (298,3,136),
  (299,3,137),
  (300,2,138),
  (301,2,139),
  (302,1,140),
  (303,1,141),
  (304,1,142),
  (305,3,143),
  (306,1,144),
  (307,2,145),
  (308,2,146),
  (309,2,147),
  (310,1,148),
  (311,2,149),
  (312,1,150),
  (313,1,151);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (314,2,152),
  (315,1,153),
  (316,1,154),
  (317,1,155),
  (318,3,156),
  (319,2,157),
  (320,1,158),
  (321,1,159),
  (322,1,160),
  (323,3,161),
  (324,3,162),
  (325,1,163),
  (326,3,164),
  (327,2,165),
  (328,1,166),
  (329,1,167),
  (330,2,168),
  (331,1,169),
  (332,1,170),
  (333,3,171),
  (334,2,172),
  (335,1,173),
  (336,1,174),
  (337,1,175),
  (338,2,176),
  (339,2,177),
  (340,2,178),
  (341,2,179),
  (342,3,180),
  (343,2,181),
  (344,1,182),
  (345,2,183),
  (346,3,184),
  (347,2,185),
  (348,3,186),
  (349,3,187),
  (350,2,188),
  (351,3,189),
  (352,2,190),
  (353,1,191),
  (354,1,192),
  (355,2,193),
  (356,2,194),
  (357,2,195),
  (358,3,196),
  (359,2,197),
  (360,3,198),
  (361,3,199),
  (362,2,200),
  (363,1,201);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (364,1,202),
  (365,2,203),
  (366,2,204),
  (367,2,205),
  (368,3,206),
  (369,1,207),
  (370,1,208),
  (371,2,209),
  (372,1,210),
  (373,3,211),
  (374,1,212),
  (375,2,213),
  (376,2,214),
  (377,2,215),
  (378,2,216),
  (379,2,217),
  (380,1,218),
  (381,1,219),
  (382,2,220),
  (383,2,221),
  (384,3,222),
  (385,2,223),
  (386,2,224),
  (387,2,225),
  (388,3,226),
  (389,2,227),
  (390,1,228),
  (391,2,229),
  (392,2,230),
  (393,1,231),
  (394,2,232),
  (395,2,233),
  (396,2,234),
  (397,3,235),
  (398,2,236),
  (399,3,237),
  (400,1,238),
  (401,3,239),
  (402,3,240),
  (403,3,241),
  (404,1,242),
  (405,3,243),
  (406,1,244),
  (407,2,245),
  (408,2,246),
  (409,3,247),
  (410,2,248),
  (411,2,249),
  (412,1,250),
  (413,2,251);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (414,1,252),
  (415,1,253),
  (416,2,254),
  (417,3,255),
  (418,1,256),
  (419,2,257),
  (420,2,258),
  (421,3,259),
  (422,2,260),
  (423,3,261),
  (424,1,262),
  (425,1,263),
  (426,1,264),
  (427,2,265),
  (428,2,266),
  (429,1,267),
  (430,2,268),
  (431,2,269),
  (432,2,270),
  (433,3,271),
  (434,2,272),
  (435,3,273),
  (436,2,274),
  (437,2,275),
  (438,2,276),
  (439,2,277),
  (440,3,278),
  (441,1,279),
  (442,3,280),
  (443,3,281),
  (444,1,282),
  (445,3,283),
  (446,2,284),
  (447,1,285),
  (448,3,286),
  (449,2,287),
  (450,3,288),
  (451,1,289),
  (452,2,290),
  (453,1,291),
  (454,2,292),
  (455,2,293),
  (456,2,294),
  (457,1,295),
  (458,2,296),
  (459,2,297),
  (460,2,298),
  (461,3,299),
  (462,3,300),
  (463,3,301);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (464,2,302),
  (465,1,303),
  (466,3,304),
  (467,2,305),
  (468,1,306),
  (469,2,307),
  (470,3,308),
  (471,2,309),
  (472,2,310),
  (473,1,311),
  (474,1,312),
  (475,1,313),
  (476,2,314),
  (477,2,315),
  (478,2,316),
  (479,2,317),
  (480,2,318),
  (481,2,319),
  (482,2,320),
  (483,2,321),
  (484,3,322),
  (485,2,323),
  (486,2,324),
  (487,3,325),
  (488,3,326),
  (489,1,327),
  (490,1,328),
  (491,1,329),
  (492,1,330),
  (493,3,331),
  (494,1,332),
  (495,2,333),
  (496,3,334),
  (497,2,335),
  (498,1,336),
  (499,1,337),
  (500,2,338),
  (501,1,339),
  (502,3,340),
  (503,2,341),
  (504,1,342),
  (505,2,343),
  (506,1,344),
  (507,2,345),
  (508,1,346),
  (509,3,347),
  (510,1,348),
  (511,3,349),
  (512,2,350),
  (513,1,351);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (514,3,352),
  (515,2,353),
  (516,2,354),
  (517,2,355),
  (518,2,356),
  (519,2,357),
  (520,2,358),
  (521,1,359),
  (522,2,360),
  (523,2,361),
  (524,2,362),
  (525,2,363),
  (526,1,364),
  (527,2,365),
  (528,1,366),
  (529,3,367),
  (530,1,368),
  (531,1,369),
  (532,2,370),
  (533,3,371),
  (534,3,372),
  (535,2,373),
  (536,2,374),
  (537,3,375),
  (538,3,376),
  (539,3,377),
  (540,1,378),
  (541,2,379),
  (542,3,380),
  (543,2,381),
  (544,2,382),
  (545,3,383),
  (546,3,384),
  (547,3,385),
  (548,3,386),
  (549,3,387),
  (550,2,388),
  (551,2,389),
  (552,2,390),
  (553,1,391),
  (554,2,392),
  (555,2,393),
  (556,1,394),
  (557,1,395),
  (558,2,396),
  (559,2,397),
  (560,3,398),
  (561,3,399),
  (562,3,400),
  (563,2,401);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (564,1,402),
  (565,2,403),
  (566,2,404),
  (567,3,405),
  (568,2,406),
  (569,2,407),
  (570,2,408),
  (571,3,409),
  (572,2,410),
  (573,2,411),
  (574,2,412),
  (575,2,413),
  (576,3,414),
  (577,3,415),
  (578,2,416),
  (579,3,417),
  (580,2,418),
  (581,2,419),
  (582,1,420),
  (583,2,421),
  (584,2,422),
  (585,2,423),
  (586,2,424),
  (587,2,425),
  (588,2,426),
  (589,3,427),
  (590,2,428),
  (591,2,429),
  (592,3,430),
  (593,2,431),
  (594,2,432),
  (595,2,433),
  (596,1,434),
  (597,2,435),
  (598,3,436),
  (599,1,437),
  (600,2,438),
  (601,2,439),
  (602,2,440),
  (603,2,441),
  (604,3,442),
  (605,2,443),
  (606,3,444),
  (607,1,445),
  (608,3,446),
  (609,3,447),
  (610,2,448),
  (611,2,449),
  (612,3,450),
  (613,2,451);
INSERT INTO tarjeta (cvv,tarjeta_id,customer_id)
VALUES
  (614,1,452),
  (615,1,453),
  (616,2,454),
  (617,1,455),
  (618,3,456),
  (619,2,457),
  (620,1,458),
  (621,1,459),
  (622,2,460),
  (623,3,461),
  (624,3,462),
  (625,2,463),
  (626,2,464),
  (627,2,465),
  (628,1,466),
  (629,2,467),
  (630,2,468),
  (631,1,469),
  (632,2,470),
  (633,2,471),
  (634,3,472),
  (635,3,473),
  (636,1,474),
  (637,3,475),
  (638,2,476),
  (639,2,477),
  (640,2,478),
  (641,1,479),
  (642,1,480),
  (643,1,481),
  (644,2,482),
  (645,1,483),
  (646,3,484),
  (647,1,485),
  (648,3,486),
  (649,1,487),
  (650,3,488),
  (651,2,489),
  (652,2,490),
  (653,2,491),
  (654,1,492),
  (655,2,493),
  (656,1,494),
  (657,3,495),
  (658,2,496),
  (659,2,497),
  (660,1,498),
  (661,3,499),
  (662,1,500);

 /*Aca agregamos 500 numeros aleatorios de tarjeta*/

/*Consulta tabla tarjeta*/ 
SELECT * 
FROM tarjeta;
				
/*Agregado entidad direcciones*/ /*Puede ser usada por los clientes, empleados y sucursales con los campos utilizados en el SPRINT 5*/
CREATE TABLE direcciones( 
				direccion_id INTEGER NOT NULL PRIMARY KEY,
				calle TEXT NOT NULL,
				numero INTEGER NOT NULL,
				ciudad TEXT NOT NULL,
				provincia TEXT NOT NULL,
				pais TEXT NOT NULL DEFAULT 'Argentina'
				);

/*Agregar 500 direcciones*/
INSERT INTO direcciones (calle, numero, ciudad, provincia)
VALUES ('Av Corrientes',1538,'Capital Federal','Buenos Aires'),
('Av Corrientes',1933,'Capital Federal','Buenos Aires'),
('Av Corrientes',2012,'Capital Federal','Buenos Aires'),
('Av Corrientes',1332,'Capital Federal','Buenos Aires'),
('Av Corrientes',2799,'Capital Federal','Buenos Aires'),
('Av Corrientes',1749,'Capital Federal','Buenos Aires'),
('Av Corrientes',1503,'Capital Federal','Buenos Aires'),
('Av Corrientes',3649,'Capital Federal','Buenos Aires'),
('Av Corrientes',3363,'Capital Federal','Buenos Aires'),
('Av Corrientes',1752,'Capital Federal','Buenos Aires'),
('Av Corrientes',1569,'Capital Federal','Buenos Aires'),
('Av Corrientes',3437,'Capital Federal','Buenos Aires'),
('Av Corrientes',1503,'Capital Federal','Buenos Aires'),
('Av Corrientes',3600,'Capital Federal','Buenos Aires'),
('Av Corrientes',3315,'Capital Federal','Buenos Aires'),
('Av Corrientes',2653,'Capital Federal','Buenos Aires'),
('Av Corrientes',1960,'Capital Federal','Buenos Aires'),
('Av Corrientes',1019,'Capital Federal','Buenos Aires'),
('Av Corrientes',3706,'Capital Federal','Buenos Aires'),
('Av Corrientes',1320,'Capital Federal','Buenos Aires'),
('Av Corrientes',3700,'Capital Federal','Buenos Aires'),
('Av Cordoba',2018,'Capital Federal','Buenos Aires'),
('Av Cordoba',1766,'Capital Federal','Buenos Aires'),
('Av Cordoba',1565,'Capital Federal','Buenos Aires'),
('Av Cordoba',1637,'Capital Federal','Buenos Aires'),
('Av Cordoba',1431,'Capital Federal','Buenos Aires'),
('Av Cordoba',2264,'Capital Federal','Buenos Aires'),
('Av Cordoba',3486,'Capital Federal','Buenos Aires'),
('Av Cordoba',1701,'Capital Federal','Buenos Aires'),
('Av Cordoba',3708,'Capital Federal','Buenos Aires'),
('Av Cordoba',2766,'Capital Federal','Buenos Aires'),
('Av Cordoba',1633,'Capital Federal','Buenos Aires'),
('Av Cordoba',2826,'Capital Federal','Buenos Aires'),
('Av Cordoba',1144,'Capital Federal','Buenos Aires'),
('Av Cordoba',3305,'Capital Federal','Buenos Aires'),
('Av Cordoba',3731,'Capital Federal','Buenos Aires'),
('Av Cordoba',3146,'Capital Federal','Buenos Aires'),
('Av Cordoba',3088,'Capital Federal','Buenos Aires'),
('Av Cordoba',3301,'Capital Federal','Buenos Aires'),
('Av Cordoba',3982,'Capital Federal','Buenos Aires'),
('Av Cordoba',1756,'Capital Federal','Buenos Aires'),
('Av Cordoba',2616,'Capital Federal','Buenos Aires'),
('Av Cordoba',1527,'Capital Federal','Buenos Aires'),
('Av Cordoba',1485,'Capital Federal','Buenos Aires'),
('Av Cordoba',1313,'Capital Federal','Buenos Aires'),
('Av Cordoba',2642,'Capital Federal','Buenos Aires'),
('Av Cordoba',2435,'Capital Federal','Buenos Aires'),
('Av Cordoba',1185,'Capital Federal','Buenos Aires'),
('Av Cordoba',2245,'Capital Federal','Buenos Aires'),
('Calchaqui',2433,'Quilmes','Buenos Aires'),
('Calchaqui',2126,'Quilmes','Buenos Aires'),
('Calchaqui',3180,'Quilmes','Buenos Aires'),
('Calchaqui',2661,'Quilmes','Buenos Aires'),
('Calchaqui',2726,'Quilmes','Buenos Aires'),
('Calchaqui',3993,'Quilmes','Buenos Aires'),
('Calchaqui',1340,'Quilmes','Buenos Aires'),
('Calchaqui',3583,'Quilmes','Buenos Aires'),
('Calchaqui',3182,'Quilmes','Buenos Aires'),
('Calchaqui',1153,'Quilmes','Buenos Aires'),
('Calchaqui',1981,'Quilmes','Buenos Aires'),
('Calchaqui',3630,'Quilmes','Buenos Aires'),
('Calchaqui',1043,'Quilmes','Buenos Aires'),
('Calchaqui',2166,'Quilmes','Buenos Aires'),
('Calchaqui',1232,'Quilmes','Buenos Aires'),
('Calchaqui',3073,'Quilmes','Buenos Aires'),
('Calchaqui',3323,'Quilmes','Buenos Aires'),
('Mitre',2364,'Quilmes','Buenos Aires'),
('Mitre',3790,'Quilmes','Buenos Aires'),
('Mitre',3886,'Quilmes','Buenos Aires'),
('Mitre',1753,'Quilmes','Buenos Aires'),
('Mitre',2733,'Quilmes','Buenos Aires'),
('Mitre',1558,'Quilmes','Buenos Aires'),
('Mitre',3841,'Quilmes','Buenos Aires'),
('Mitre',2795,'Quilmes','Buenos Aires'),
('Mitre',1628,'Quilmes','Buenos Aires'),
('Mitre',1283,'Quilmes','Buenos Aires'),
('Mitre',3622,'Quilmes','Buenos Aires'),
('Alem',2827,'Quilmes','Buenos Aires'),
('Alem',1638,'Quilmes','Buenos Aires'),
('Alem',2625,'Quilmes','Buenos Aires'),
('Alem',2047,'Quilmes','Buenos Aires'),
('Alem',2521,'Quilmes','Buenos Aires'),
('Alem',1931,'Quilmes','Buenos Aires'),
('Alem',1195,'Quilmes','Buenos Aires'),
('Alem',1330,'Quilmes','Buenos Aires'),
('Alem',3775,'Quilmes','Buenos Aires'),
('Alem',3362,'Quilmes','Buenos Aires'),
('Alem',2524,'Quilmes','Buenos Aires'),
('Alem',3014,'Quilmes','Buenos Aires'),
('Alem',3944,'Quilmes','Buenos Aires'),
('Alem',2373,'Quilmes','Buenos Aires'),
('Alem',3482,'Quilmes','Buenos Aires'),
('Alem',1730,'Quilmes','Buenos Aires'),
('Alem',2185,'Quilmes','Buenos Aires'),
('Alem',3055,'Quilmes','Buenos Aires'),
('Calle 14',1319,'La Plata','Buenos Aires'),
('Calle 15',1622,'La Plata','Buenos Aires'),
('Calle 16',2203,'La Plata','Buenos Aires'),
('Calle 17',3112,'La Plata','Buenos Aires'),
('Calle 18',3902,'La Plata','Buenos Aires'),
('Calle 19',3248,'La Plata','Buenos Aires'),
('Calle 20',3942,'La Plata','Buenos Aires'),
('Calle 21',2830,'La Plata','Buenos Aires'),
('Calle 22',2817,'La Plata','Buenos Aires'),
('Calle 23',3046,'La Plata','Buenos Aires'),
('Calle 24',2316,'La Plata','Buenos Aires'),
('Calle 25',2457,'La Plata','Buenos Aires'),
('Calle 26',3564,'La Plata','Buenos Aires'),
('Diagonal 74',2030,'La Plata','Buenos Aires'),
('Diagonal 75',2720,'La Plata','Buenos Aires'),
('Diagonal 76',2957,'La Plata','Buenos Aires'),
('Diagonal 77',1741,'La Plata','Buenos Aires'),
('Diagonal 78',2382,'La Plata','Buenos Aires'),
('Diagonal 79',3980,'La Plata','Buenos Aires'),
('Diagonal 80',1552,'La Plata','Buenos Aires'),
('Diagonal 81',1475,'La Plata','Buenos Aires'),
('Diagonal 82',1575,'La Plata','Buenos Aires'),
('Diagonal 83',3198,'La Plata','Buenos Aires'),
('Diagonal 84',1243,'La Plata','Buenos Aires'),
('Diagonal 85',2687,'La Plata','Buenos Aires'),
('Diagonal 86',3598,'La Plata','Buenos Aires'),
('Diagonal 87',1115,'La Plata','Buenos Aires'),
('Diagonal 88',3963,'La Plata','Buenos Aires'),
('Diagonal 89',3891,'La Plata','Buenos Aires'),
('Diagonal 90',3672,'La Plata','Buenos Aires'),
('Presidente Roca',1761,'Rosario','Santa Fe'),
('Presidente Roca',1404,'Rosario','Santa Fe'),
('Presidente Roca',2139,'Rosario','Santa Fe'),
('Presidente Roca',3058,'Rosario','Santa Fe'),
('Presidente Roca',3705,'Rosario','Santa Fe'),
('Presidente Roca',3891,'Rosario','Santa Fe'),
('Presidente Roca',1261,'Rosario','Santa Fe'),
('Presidente Roca',2892,'Rosario','Santa Fe'),
('Presidente Roca',1681,'Rosario','Santa Fe'),
('Presidente Roca',3646,'Rosario','Santa Fe'),
('Presidente Roca',2109,'Rosario','Santa Fe'),
('Presidente Roca',1137,'Rosario','Santa Fe'),
('Presidente Roca',3865,'Rosario','Santa Fe'),
('Presidente Roca',1774,'Rosario','Santa Fe'),
('Presidente Roca',1076,'Rosario','Santa Fe'),
('Presidente Roca',2633,'Rosario','Santa Fe'),
('Presidente Roca',2907,'Rosario','Santa Fe'),
('Presidente Roca',1709,'Rosario','Santa Fe'),
('Cordoba',1694,'Rosario','Santa Fe'),
('Cordoba',2468,'Rosario','Santa Fe'),
('Cordoba',2679,'Rosario','Santa Fe'),
('Cordoba',3229,'Rosario','Santa Fe'),
('Cordoba',3370,'Rosario','Santa Fe'),
('Cordoba',1617,'Rosario','Santa Fe'),
('Cordoba',3583,'Rosario','Santa Fe'),
('Cordoba',1084,'Rosario','Santa Fe'),
('Cordoba',3146,'Rosario','Santa Fe'),
('Cordoba',2389,'Rosario','Santa Fe'),
('Cordoba',3077,'Rosario','Santa Fe'),
('Cordoba',1340,'Rosario','Santa Fe'),
('Cordoba',2154,'Rosario','Santa Fe'),
('Cordoba',2029,'Rosario','Santa Fe'),
('Cordoba',2821,'Rosario','Santa Fe'),
('Honorio',2651,'Rosario','Santa Fe'),
('Honorio',2350,'Rosario','Santa Fe'),
('Honorio',3327,'Rosario','Santa Fe'),
('Honorio',1390,'Rosario','Santa Fe'),
('Honorio',1108,'Rosario','Santa Fe'),
('Honorio',3843,'Rosario','Santa Fe'),
('Honorio',3320,'Rosario','Santa Fe'),
('Honorio',3275,'Rosario','Santa Fe'),
('Entre Rios',2589,'Rosario','Santa Fe'),
('Entre Rios',3372,'Rosario','Santa Fe'),
('Entre Rios',2729,'Rosario','Santa Fe'),
('Entre Rios',1511,'Rosario','Santa Fe'),
('Entre Rios',2886,'Rosario','Santa Fe'),
('Entre Rios',1568,'Rosario','Santa Fe'),
('Entre Rios',3775,'Rosario','Santa Fe'),
('Entre Rios',1075,'Rosario','Santa Fe'),
('Entre Rios',3663,'Rosario','Santa Fe'),
('Chubut',3722,'Villa Constitucion','Santa Fe'),
('Chubut',1925,'Villa Constitucion','Santa Fe'),
('Chubut',3132,'Villa Constitucion','Santa Fe'),
('Chubut',1941,'Villa Constitucion','Santa Fe'),
('Chubut',2907,'Villa Constitucion','Santa Fe'),
('Chubut',3945,'Villa Constitucion','Santa Fe'),
('Chubut',3232,'Villa Constitucion','Santa Fe'),
('Chubut',1812,'Villa Constitucion','Santa Fe'),
('Chubut',2226,'Villa Constitucion','Santa Fe'),
('Dorrego',2716,'Villa Constitucion','Santa Fe'),
('Dorrego',1269,'Villa Constitucion','Santa Fe'),
('Dorrego',3504,'Villa Constitucion','Santa Fe'),
('Dorrego',1725,'Villa Constitucion','Santa Fe'),
('Dorrego',3098,'Villa Constitucion','Santa Fe'),
('Dorrego',3689,'Villa Constitucion','Santa Fe'),
('Dorrego',2210,'Villa Constitucion','Santa Fe'),
('Dorrego',3503,'Villa Constitucion','Santa Fe'),
('Dorrego',3980,'Villa Constitucion','Santa Fe'),
('Dorrego',2983,'Villa Constitucion','Santa Fe'),
('Dorrego',3937,'Villa Constitucion','Santa Fe'),
('Brown',3308,'Villa Constitucion','Santa Fe'),
('Brown',3050,'Villa Constitucion','Santa Fe'),
('Brown',3341,'Villa Constitucion','Santa Fe'),
('Brown',1362,'Villa Constitucion','Santa Fe'),
('Brown',2176,'Villa Constitucion','Santa Fe'),
('Brown',3806,'Villa Constitucion','Santa Fe'),
('Brown',2887,'Villa Constitucion','Santa Fe'),
('Brown',2872,'Villa Constitucion','Santa Fe'),
('Brown',2030,'Villa Constitucion','Santa Fe'),
('Brown',1211,'Villa Constitucion','Santa Fe'),
('Brown',3881,'Villa Constitucion','Santa Fe'),
('Brown',2027,'Villa Constitucion','Santa Fe'),
('Urquiza',1126,'Villa Constitucion','Santa Fe'),
('Urquiza',1720,'Villa Constitucion','Santa Fe'),
('Urquiza',3460,'Villa Constitucion','Santa Fe'),
('Urquiza',2732,'Villa Constitucion','Santa Fe'),
('Urquiza',1600,'Villa Constitucion','Santa Fe'),
('Urquiza',1523,'Villa Constitucion','Santa Fe'),
('Urquiza',3941,'Villa Constitucion','Santa Fe'),
('Urquiza',1462,'Villa Constitucion','Santa Fe'),
('Urquiza',1797,'Villa Constitucion','Santa Fe'),
('Urquiza',1158,'Villa Constitucion','Santa Fe'),
('Urquiza',3510,'Villa Constitucion','Santa Fe'),
('Urquiza',1919,'Villa Constitucion','Santa Fe'),
('Urquiza',3801,'Villa Constitucion','Santa Fe'),
('Urquiza',2441,'Villa Constitucion','Santa Fe'),
('Urquiza',1650,'Villa Constitucion','Santa Fe'),
('Urquiza',2005,'Villa Constitucion','Santa Fe'),
('Urquiza',1611,'Villa Constitucion','Santa Fe'),
('Urquiza',2834,'Villa Constitucion','Santa Fe'),
('Urquiza',1361,'Villa Constitucion','Santa Fe'),
('Urquiza',2086,'Villa Constitucion','Santa Fe'),
('Urquiza',1947,'Villa Constitucion','Santa Fe'),
('Urquiza',1022,'Villa Constitucion','Santa Fe'),
('Urquiza',3027,'Villa Constitucion','Santa Fe'),
('Urquiza',3009,'Villa Constitucion','Santa Fe'),
('Urquiza',2717,'Villa Constitucion','Santa Fe'),
('Urquiza',1980,'Villa Constitucion','Santa Fe'),
('Urquiza',1949,'Villa Constitucion','Santa Fe'),
('Urquiza',1075,'Villa Constitucion','Santa Fe'),
('Urquiza',2430,'Villa Constitucion','Santa Fe'),
('Urquiza',3720,'Villa Constitucion','Santa Fe'),
('Urquiza',2547,'Villa Constitucion','Santa Fe'),
('Urquiza',1297,'Villa Constitucion','Santa Fe'),
('Urquiza',2248,'Villa Constitucion','Santa Fe'),
('Urquiza',2073,'Villa Constitucion','Santa Fe'),
('Urquiza',1376,'Villa Constitucion','Santa Fe'),
('Urquiza',3953,'Villa Constitucion','Santa Fe'),
('Urquiza',3786,'Villa Constitucion','Santa Fe'),
('Urquiza',1544,'Villa Constitucion','Santa Fe'),
('Urquiza',2913,'Villa Constitucion','Santa Fe'),
('Urquiza',3447,'Villa Constitucion','Santa Fe'),
('Urquiza',2590,'Villa Constitucion','Santa Fe'),
('Urquiza',3181,'Villa Constitucion','Santa Fe'),
('Urquiza',1776,'Villa Constitucion','Santa Fe'),
('Independencia',3579,'Carlos Paz','Cordoba'),
('Independencia',1011,'Carlos Paz','Cordoba'),
('Independencia',3949,'Carlos Paz','Cordoba'),
('Independencia',2212,'Carlos Paz','Cordoba'),
('Independencia',1376,'Carlos Paz','Cordoba'),
('Independencia',3263,'Carlos Paz','Cordoba'),
('Independencia',1494,'Carlos Paz','Cordoba'),
('Independencia',3364,'Carlos Paz','Cordoba'),
('Independencia',3063,'Carlos Paz','Cordoba'),
('Independencia',1384,'Carlos Paz','Cordoba'),
('Independencia',3311,'Carlos Paz','Cordoba'),
('Independencia',2034,'Carlos Paz','Cordoba'),
('Independencia',3329,'Carlos Paz','Cordoba'),
('Independencia',3901,'Carlos Paz','Cordoba'),
('Independencia',1617,'Carlos Paz','Cordoba'),
('Independencia',1089,'Carlos Paz','Cordoba'),
('Independencia',3545,'Carlos Paz','Cordoba'),
('Independencia',3838,'Carlos Paz','Cordoba'),
('Independencia',3472,'Carlos Paz','Cordoba'),
('Independencia',2294,'Carlos Paz','Cordoba'),
('Independencia',2424,'Carlos Paz','Cordoba'),
('Independencia',3824,'Carlos Paz','Cordoba'),
('Independencia',2547,'Carlos Paz','Cordoba'),
('Independencia',2298,'Carlos Paz','Cordoba'),
('Independencia',3069,'Carlos Paz','Cordoba'),
('Independencia',2177,'Carlos Paz','Cordoba'),
('Independencia',1894,'Carlos Paz','Cordoba'),
('Independencia',2838,'Carlos Paz','Cordoba'),
('Independencia',3553,'Carlos Paz','Cordoba'),
('Independencia',1459,'Carlos Paz','Cordoba'),
('Independencia',2271,'Carlos Paz','Cordoba'),
('Independencia',3176,'Carlos Paz','Cordoba'),
('Independencia',1263,'Carlos Paz','Cordoba'),
('Independencia',3745,'Carlos Paz','Cordoba'),
('Independencia',1011,'Carlos Paz','Cordoba'),
('Independencia',2491,'Carlos Paz','Cordoba'),
('Independencia',2331,'Carlos Paz','Cordoba'),
('Independencia',2242,'Carlos Paz','Cordoba'),
('Independencia',3594,'Carlos Paz','Cordoba'),
('Independencia',2660,'Carlos Paz','Cordoba'),
('Independencia',2374,'Carlos Paz','Cordoba'),
('Independencia',2658,'Carlos Paz','Cordoba'),
('Azopardo',1718,'Carlos Paz','Cordoba'),
('Azopardo',2669,'Carlos Paz','Cordoba'),
('Azopardo',2598,'Carlos Paz','Cordoba'),
('Azopardo',2860,'Carlos Paz','Cordoba'),
('Azopardo',1940,'Carlos Paz','Cordoba'),
('Azopardo',2389,'Carlos Paz','Cordoba'),
('Azopardo',1575,'Carlos Paz','Cordoba'),
('Azopardo',2026,'Carlos Paz','Cordoba'),
('Azopardo',3525,'Carlos Paz','Cordoba'),
('Azopardo',3877,'Carlos Paz','Cordoba'),
('Azopardo',3254,'Carlos Paz','Cordoba'),
('Azopardo',1888,'Carlos Paz','Cordoba'),
('Azopardo',3304,'Carlos Paz','Cordoba'),
('Azopardo',3179,'Carlos Paz','Cordoba'),
('Azopardo',2664,'Carlos Paz','Cordoba'),
('Azopardo',1283,'Carlos Paz','Cordoba'),
('Azopardo',3891,'Carlos Paz','Cordoba'),
('Azopardo',3066,'Carlos Paz','Cordoba'),
('Azopardo',2179,'Carlos Paz','Cordoba'),
('Azopardo',1432,'Carlos Paz','Cordoba'),
('Azopardo',1549,'Carlos Paz','Cordoba'),
('Azopardo',2425,'Carlos Paz','Cordoba'),
('Azopardo',1655,'Carlos Paz','Cordoba'),
('Azopardo',1387,'Carlos Paz','Cordoba'),
('Azopardo',2034,'Carlos Paz','Cordoba'),
('Azopardo',2098,'Carlos Paz','Cordoba'),
('Azopardo',2914,'Carlos Paz','Cordoba'),
('Azopardo',2494,'Carlos Paz','Cordoba'),
('Chacabuco',1130,'Carlos Paz','Cordoba'),
('Chacabuco',3677,'Carlos Paz','Cordoba'),
('Chacabuco',2889,'Carlos Paz','Cordoba'),
('Chacabuco',2375,'Carlos Paz','Cordoba'),
('Chacabuco',1113,'Carlos Paz','Cordoba'),
('Chacabuco',1764,'Carlos Paz','Cordoba'),
('Chacabuco',2299,'Carlos Paz','Cordoba'),
('Chacabuco',2667,'Carlos Paz','Cordoba'),
('Chacabuco',3520,'Carlos Paz','Cordoba'),
('Chacabuco',2045,'Carlos Paz','Cordoba'),
('Chacabuco',3450,'Carlos Paz','Cordoba'),
('Chacabuco',1284,'Carlos Paz','Cordoba'),
('Chacabuco',3779,'Carlos Paz','Cordoba'),
('Chacabuco',2463,'Carlos Paz','Cordoba'),
('Chacabuco',1632,'Carlos Paz','Cordoba'),
('Chacabuco',2989,'Carlos Paz','Cordoba'),
('Chacabuco',2638,'Carlos Paz','Cordoba'),
('Chacabuco',2089,'Carlos Paz','Cordoba'),
('Chacabuco',2818,'Carlos Paz','Cordoba'),
('Chacabuco',3190,'Carlos Paz','Cordoba'),
('Chacabuco',2717,'Carlos Paz','Cordoba'),
('Chacabuco',1850,'Carlos Paz','Cordoba'),
('Chacabuco',2989,'Carlos Paz','Cordoba'),
('Chacabuco',2502,'Carlos Paz','Cordoba'),
('Chacabuco',2696,'Carlos Paz','Cordoba'),
('Chacabuco',1126,'Carlos Paz','Cordoba'),
('Chacabuco',1471,'Carlos Paz','Cordoba'),
('Chacabuco',2158,'Carlos Paz','Cordoba'),
('Chacabuco',1496,'Carlos Paz','Cordoba'),
('Chacabuco',3767,'Carlos Paz','Cordoba'),
('Chacabuco',2485,'Carlos Paz','Cordoba'),
('Chacabuco',2984,'Carlos Paz','Cordoba'),
('Zuviria',1946,'Carlos Paz','Cordoba'),
('Zuviria',2553,'Carlos Paz','Cordoba'),
('Zuviria',1777,'Carlos Paz','Cordoba'),
('Zuviria',2032,'Carlos Paz','Cordoba'),
('Zuviria',1706,'Carlos Paz','Cordoba'),
('Zuviria',2538,'Carlos Paz','Cordoba'),
('Zuviria',1388,'Carlos Paz','Cordoba'),
('Zuviria',1253,'Carlos Paz','Cordoba'),
('Zuviria',3725,'Carlos Paz','Cordoba'),
('Zuviria',3204,'Carlos Paz','Cordoba'),
('Zuviria',1883,'Carlos Paz','Cordoba'),
('Zuviria',1589,'Carlos Paz','Cordoba'),
('Zuviria',1770,'Carlos Paz','Cordoba'),
('Zuviria',2465,'Carlos Paz','Cordoba'),
('Zuviria',3027,'Carlos Paz','Cordoba'),
('Zuviria',2046,'Carlos Paz','Cordoba'),
('Zuviria',2186,'Carlos Paz','Cordoba'),
('Zuviria',1468,'Carlos Paz','Cordoba'),
('Zuviria',2411,'Carlos Paz','Cordoba'),
('Zuviria',3977,'Carlos Paz','Cordoba'),
('Zuviria',1779,'Carlos Paz','Cordoba'),
('Zuviria',2992,'Carlos Paz','Cordoba'),
('Zuviria',2229,'Carlos Paz','Cordoba'),
('Godoy',2172,'Neuquen','Neuquen'),
('Godoy',1048,'Neuquen','Neuquen'),
('Godoy',2938,'Neuquen','Neuquen'),
('Godoy',3757,'Neuquen','Neuquen'),
('Godoy',1850,'Neuquen','Neuquen'),
('Godoy',3674,'Neuquen','Neuquen'),
('Godoy',3210,'Neuquen','Neuquen'),
('Godoy',2719,'Neuquen','Neuquen'),
('Godoy',1232,'Neuquen','Neuquen'),
('Godoy',2369,'Neuquen','Neuquen'),
('Godoy',3511,'Neuquen','Neuquen'),
('Godoy',1005,'Neuquen','Neuquen'),
('Godoy',2386,'Neuquen','Neuquen'),
('Frontera',1192,'Neuquen','Neuquen'),
('Frontera',3729,'Neuquen','Neuquen'),
('Frontera',2452,'Neuquen','Neuquen'),
('Frontera',1300,'Neuquen','Neuquen'),
('Frontera',2579,'Neuquen','Neuquen'),
('Frontera',2689,'Neuquen','Neuquen'),
('Frontera',2107,'Neuquen','Neuquen'),
('Frontera',3731,'Neuquen','Neuquen'),
('Frontera',2903,'Neuquen','Neuquen'),
('Frontera',1835,'Neuquen','Neuquen'),
('Frontera',1770,'Neuquen','Neuquen'),
('Frontera',2336,'Neuquen','Neuquen'),
('Frontera',3608,'Neuquen','Neuquen'),
('Frontera',3219,'Neuquen','Neuquen'),
('Aconcagua',3252,'Neuquen','Neuquen'),
('Aconcagua',2763,'Neuquen','Neuquen'),
('Aconcagua',1963,'Neuquen','Neuquen'),
('Aconcagua',2552,'Neuquen','Neuquen'),
('Aconcagua',2041,'Neuquen','Neuquen'),
('Aconcagua',3334,'Neuquen','Neuquen'),
('Aconcagua',2771,'Neuquen','Neuquen'),
('Aconcagua',1598,'Neuquen','Neuquen'),
('Aconcagua',3741,'Neuquen','Neuquen'),
('Aconcagua',2888,'Neuquen','Neuquen'),
('Aconcagua',1332,'Neuquen','Neuquen'),
('Aconcagua',1133,'Neuquen','Neuquen'),
('Aconcagua',3283,'Neuquen','Neuquen'),
('Aconcagua',1278,'Neuquen','Neuquen'),
('Aconcagua',3611,'Neuquen','Neuquen'),
('Aconcagua',2072,'Neuquen','Neuquen'),
('Aconcagua',3341,'Neuquen','Neuquen'),
('Aconcagua',2397,'Neuquen','Neuquen'),
('Aconcagua',3892,'Neuquen','Neuquen'),
('Aconcagua',2813,'Neuquen','Neuquen'),
('Aconcagua',1271,'Neuquen','Neuquen'),
('Aconcagua',1156,'Neuquen','Neuquen'),
('Aconcagua',1666,'Neuquen','Neuquen'),
('Aconcagua',3002,'Neuquen','Neuquen'),
('Aconcagua',1529,'Neuquen','Neuquen'),
('Aconcagua',2019,'Neuquen','Neuquen'),
('Aconcagua',2429,'Neuquen','Neuquen'),
('Aconcagua',3486,'Neuquen','Neuquen'),
('Aconcagua',1774,'Neuquen','Neuquen'),
('Aconcagua',3232,'Neuquen','Neuquen'),
('Aconcagua',1028,'Neuquen','Neuquen'),
('Aconcagua',1686,'Neuquen','Neuquen'),
('Aconcagua',3910,'Neuquen','Neuquen'),
('Aconcagua',3592,'Neuquen','Neuquen'),
('Aconcagua',1549,'Neuquen','Neuquen'),
('Aconcagua',2376,'Neuquen','Neuquen'),
('Aconcagua',2779,'Neuquen','Neuquen'),
('Aconcagua',1796,'Neuquen','Neuquen'),
('Aconcagua',1018,'Neuquen','Neuquen'),
('Aconcagua',3939,'Neuquen','Neuquen'),
('Aconcagua',1475,'Neuquen','Neuquen'),
('Aconcagua',2196,'Neuquen','Neuquen'),
('Aconcagua',2389,'Neuquen','Neuquen'),
('Aconcagua',2200,'Neuquen','Neuquen'),
('Aconcagua',2492,'Neuquen','Neuquen'),
('Aconcagua',3165,'Neuquen','Neuquen'),
('Perito Moreno',3083,'San Martin de los Andes','Neuquen'),
('Perito Moreno',2854,'San Martin de los Andes','Neuquen'),
('Perito Moreno',1902,'San Martin de los Andes','Neuquen'),
('Perito Moreno',3496,'San Martin de los Andes','Neuquen'),
('Perito Moreno',3142,'San Martin de los Andes','Neuquen'),
('Perito Moreno',3277,'San Martin de los Andes','Neuquen'),
('Perito Moreno',2603,'San Martin de los Andes','Neuquen'),
('Perito Moreno',1433,'San Martin de los Andes','Neuquen'),
('Perito Moreno',3025,'San Martin de los Andes','Neuquen'),
('Perito Moreno',2024,'San Martin de los Andes','Neuquen'),
('Perito Moreno',3874,'San Martin de los Andes','Neuquen'),
('Molina Campos',1341,'San Martin de los Andes','Neuquen'),
('Molina Campos',1723,'San Martin de los Andes','Neuquen'),
('Molina Campos',2120,'San Martin de los Andes','Neuquen'),
('Molina Campos',2421,'San Martin de los Andes','Neuquen'),
('Molina Campos',2998,'San Martin de los Andes','Neuquen'),
('Molina Campos',1704,'San Martin de los Andes','Neuquen'),
('Molina Campos',3424,'San Martin de los Andes','Neuquen'),
('Molina Campos',3927,'San Martin de los Andes','Neuquen'),
('Molina Campos',2899,'San Martin de los Andes','Neuquen'),
('Molina Campos',2913,'San Martin de los Andes','Neuquen'),
('Molina Campos',3711,'San Martin de los Andes','Neuquen'),
('Molina Campos',3079,'San Martin de los Andes','Neuquen'),
('Molina Campos',2128,'San Martin de los Andes','Neuquen'),
('Molina Campos',3956,'San Martin de los Andes','Neuquen'),
('Molina Campos',2453,'San Martin de los Andes','Neuquen'),
('Molina Campos',2479,'San Martin de los Andes','Neuquen'),
('Molina Campos',3043,'San Martin de los Andes','Neuquen'),
('Molina Campos',1404,'San Martin de los Andes','Neuquen'),
('Molina Campos',2721,'San Martin de los Andes','Neuquen'),
('Molina Campos',2126,'San Martin de los Andes','Neuquen'),
('Molina Campos',1070,'San Martin de los Andes','Neuquen'),
('Molina Campos',1629,'San Martin de los Andes','Neuquen'),
('Molina Campos',3391,'San Martin de los Andes','Neuquen'),
('Molina Campos',1207,'San Martin de los Andes','Neuquen'),
('Molina Campos',3048,'San Martin de los Andes','Neuquen'),
('Molina Campos',2388,'San Martin de los Andes','Neuquen'),
('Lola Mora',2368,'San Martin de los Andes','Neuquen'),
('Lola Mora',3052,'San Martin de los Andes','Neuquen'),
('Lola Mora',2335,'San Martin de los Andes','Neuquen'),
('Lola Mora',2020,'San Martin de los Andes','Neuquen'),
('Lola Mora',3937,'San Martin de los Andes','Neuquen'),
('Lola Mora',3117,'San Martin de los Andes','Neuquen'),
('Lola Mora',3707,'San Martin de los Andes','Neuquen'),
('Lola Mora',3795,'San Martin de los Andes','Neuquen'),
('Lola Mora',3045,'San Martin de los Andes','Neuquen'),
('Lola Mora',2269,'San Martin de los Andes','Neuquen'),
('Lola Mora',2090,'San Martin de los Andes','Neuquen'),
('Lola Mora',1528,'San Martin de los Andes','Neuquen'),
('Lola Mora',3005,'San Martin de los Andes','Neuquen'),
('Lola Mora',2354,'San Martin de los Andes','Neuquen');

/*Consulta tabla direcciones*/ 
SELECT * 
FROM direcciones

/*Empleado*/

/*Agrego el campo direccion_id en clientes,empleado y sucursal*/
/*empleado*/
ALTER TABLE empleado
ADD COLUMN direccion_id INTEGER;
/*Clientes*/
ALTER TABLE cliente
ADD COLUMN direccion_id INTEGER;
/*Sucursal*/
ALTER TABLE sucursal
ADD COLUMN direccion_id INTEGER;

/*Asignando del lote inicial a empleados, clientes o sucursal de forma aleatoria*/
/*empleado*/
UPDATE empleado 
SET direccion_id = (ABS(RANDOM()) % 501) + 1;
/*Clientes*/
UPDATE cliente 
SET direccion_id = (ABS(RANDOM()) % 501) + 1;
/*Sucursal*/
/*inserto valores aleatoriamente que no se repitan y modifico direccion_id para que sea UNIQUE desde database structure*/
UPDATE sucursal 
SET direccion_id = (branch_id-1)*5+(ABS(RANDOM()) % 5 + 1);

/*Amplio alcance entidad cuenta  para que identifique el tipo de la misma*/ /*Hay que agregar tipo_cuenta*/ 
				/*Se agrego la columna modificado la tabla desde database structure*/
ALTER TABLE cuenta
ADD COLUMN tipo_de_cuenta INTEGER;

/*Asignar un tipo de cuenta a cada registro de cuenta de forma aleatoria*/

/*Como ya esta creada la columna habria que agregarle los valores con un UPDATE*/
UPDATE cuenta 
SET tipo_de_cuenta = ABS(RANDOM()) % 3 + 1;

/*Corregir el campo employee_hire_date de la tabla empleado con la fecha en formato YYYY-MM-DD*/
UPDATE empleado SET employee_hire_date = substr(employee_hire_date, 7, 4) || '-' || substr(employee_hire_date, 4,2) || '-' || substr(employee_hire_date, 1,2);

/*Consulta tabla empleado*/ 
SELECT * 
FROM empleado

/*Consulta tabla sucursal*/ 
SELECT * 
FROM sucursal

/*Consulta tabla cliente*/ 
SELECT * 
FROM cliente

/*Consulta tabla tipo_cuenta*/ 
SELECT * 
FROM tipo_cuenta

/*Consulta tabla cuenta*/ 
SELECT * 
FROM cuenta

/*Segunda Problematica*/
																
/*Crear una vista con las columnas id, numero sucursal, nombre, apellido, DNI y edad de la tabla cliente calculada a partir de la fecha de nacimiento*/

CREATE VIEW v_edades
AS
SELECT 
	cliente.customer_id,
	branch_number,
	cliente.customer_name,
	cliente.customer_surname,
	cliente.customer_DNI,
	(strftime('%Y',date()) - strftime('%Y',cliente.dob)) AS  Edad
	
FROM cliente
INNER JOIN sucursal ON sucursal.branch_id=cliente.branch_id;

/*mostrar la VIEW*/
SELECT *
FROM v_edades;

/*Mostrar las columnas de los clientes, ordenadas por el DNI de menor a mayor y cuya edad sea superior a 40 años*/
SELECT *
FROM v_edades
WHERE edad>40 
ORDER BY customer_DNI ASC

/*Mostrar todos los clientes que se llaman “Anne” o “Tyler” ordenados por edad de menor a mayor*/
SELECT *
FROM v_edades
WHERE customer_name='Tyler' OR customer_name='Anne'
ORDER BY edad ASC

/*Insertar 5 nuevos clientes en la base de datos y verificar que se haya realizado con éxito la inserción*/
/*1*/
INSERT INTO cliente (customer_name, customer_surname, customer_DNI, dob, branch_id,direccion_id)
VALUES ('Lois', 'Stout', 47730534, '1984-07-07', 80, 1);
/*2*/
INSERT INTO cliente (customer_name, customer_surname, customer_DNI, dob, branch_id,direccion_id)
VALUES ('Hall', 'Mcconnell',52055464, '1968-04-30', 45, 2);
/*3*/
INSERT INTO cliente (customer_name, customer_surname, customer_DNI, dob, branch_id,direccion_id)
VALUES ('Jin', 'Cooley', 21207908, '1959-08-24', 96, 3);
/*4*/
INSERT INTO cliente (customer_name, customer_surname, customer_DNI, dob, branch_id,direccion_id)
VALUES ('Hilel', 'Mclean', 43625213, '1993-03-28',  77, 32);
/*5*/
INSERT INTO cliente (customer_name, customer_surname, customer_DNI, dob, branch_id,direccion_id)
VALUES ('Gabriel', 'Harmon',57063950,'1976-04-01',27, 55);

/*Consulta de tabla cliente para verificar la insercion*/
SELECT *
FROM cliente
WHERE customer_id>500;

/*Actualizar 5 clientes recientemente agregados en la base de datos dado que hubo un error en el JSON que traía la información, la sucursal de todos es la 10*/
UPDATE cliente
SET branch_id = 10
WHERE customer_id >= 501;

/*Eliminar el registro correspondiente a “Noel David” realizando la selección por el nombre y apellido*/
DELETE FROM cliente
WHERE customer_name='Noel' AND customer_surname='David';

/*Verifico la eliminación*/

SELECT * 
FROM cliente
WHERE customer_name='Noel' and customer_surname = 'David';

/*Consultar sobre cuál es el tipo de préstamo de mayor importe*/
SELECT loan_id, loan_type, MAX (loan_total) as Mayor_Importe
FROM prestamo;

/*Para corroborar que este bien el mayor importe*/
SELECT *
FROM prestamo
ORDER BY loan_total DESC
LIMIT 10;

/*Tercera Problematica*/
												
/*Seleccion de cuentas con saldo negativo*/
SELECT *
FROM cuenta
WHERE balance<0;

/*Seleccion datos de clientes con apellidos que contengan z*/
SELECT cliente.customer_name, cliente.customer_surname, CURRENT_DATE - dob AS age_cliente
FROM cliente
WHERE UPPER(customer_surname) LIKE '%z%' ;
 
/*Seleccion datos de clientes y sucursal cuyo nombre sea Brendan*/
SELECT customer_name, customer_surname, CURRENT_DATE - dob AS Edad_cliente, branch_name AS Nom_Sucursal
FROM (		
		SELECT *
		FROM cliente
		INNER JOIN sucursal ON cliente.branch_id = sucursal.branch_id
		)

WHERE customer_name = 'Brendan' 
ORDER BY branch_name; 


/*Seleccion prestamos prendarios y con importe mayor a $80000*/

SELECT * 
FROM prestamo
WHERE loan_total > 8000000
	UNION
SELECT * 
FROM prestamo
WHERE loan_type= 'PRENDARIO';



/*Seleccion prestamos cuyo importe sea mayor que el promedio*/

SELECT *
FROM prestamo
WHERE loan_total > (SELECT AVG(loan_total) FROM prestamo);

/*Consultar promedio*/
SELECT AVG(loan_total)
FROM prestamo;


/*Cantidad de clientes menores de 50*/
SELECT COUNT(Edad_cliente) as Edades_menores_50
FROM(
	 SELECT CURRENT_DATE - dob AS Edad_cliente
	From cliente)
WHERE Edad_cliente <50;


/*Seleccionar las 5 primeras cuentas con saldo mayor a $8000*/
SELECT *
FROM cuenta
WHERE balance > 800000
LIMIT 5;

/*Seleccionar los prestamos que tengan fecha en abril, junio y agosto*/
SELECT * 
FROM prestamo 
WHERE strftime('%m', loan_date) = '04' 
	UNION
SELECT * 
FROM prestamo 
WHERE strftime('%m', loan_date) = '06'
	UNION
SELECT * 
FROM prestamo 
WHERE strftime('%m', loan_date) = '08'
ORDER BY loan_total;


/*Importe total de los prestamos*/
SELECT loan_type, sum(loan_total) AS loan_total_accu
FROM prestamo
GROUP BY loan_type;

/*Cuarta Problematica*/
											
/*Listar la cantidad de clientes por nombre de sucursal ordenando de mayor a menor*/
SELECT COUNT(customer_id) as Cant_Clientes, branch_name
FROM cliente
INNER JOIN sucursal
ON cliente.branch_id = sucursal.branch_id
GROUP BY branch_name
ORDER BY Cant_Clientes DESC;

/*Obtener la cantidad de empleados por cliente por sucursal en un número real*/
SELECT idBranch, qClientes, qEmpleados, round((qClientes*1.0/qEmpleados*1.0), 2) as q
FROM ( SELECT sucursal.branch_id as idBranch, count(cliente.customer_id) as qClientes, qEmpleados
		FROM sucursal
		LEFT JOIN cliente
		ON sucursal.branch_id = cliente.branch_id
		LEFT JOIN (
			SELECT sucursal.branch_id as sucursalID, count(empleado.employee_id) as qEmpleados
			FROM sucursal
			LEFT JOIN empleado
			ON sucursal.branch_id = empleado.branch_id
			GROUP BY sucursal.branch_id
		) as cantidad_Empleados
		ON sucursal.branch_id = cantidad_Empleados.sucursalID
		GROUP BY sucursal.branch_id
) as Division;

/*Obtener la cantidad de tarjetas de crédito por tipo por sucursal que la entrego*/
SELECT COUNT(tarjeta.tipo_tarjeta) as Cant_tarjetas, tarjeta_id as tipo_de_tarjeta, sucursal.branch_id as Nro_Sucursal
FROM tarjeta
INNER JOIN cliente
ON tarjeta.customer_id = cliente.customer_id
INNER JOIN sucursal
ON cliente.branch_id = sucursal.branch_id
GROUP BY tarjeta_id;

/*Esto es para comprobar y ver que cada columna este bien*/
SELECT *
FROM tarjeta;

/*Obtener el promedio de créditos otorgado por sucursal*/
SELECT COUNT (loan_type) as Promedio, loan_type as tipo_credito,sucursal.branch_id,sucursal.branch_name
FROM prestamo
INNER JOIN cliente
ON prestamo.customer_id = cliente.customer_id
INNER JOIN sucursal
ON sucursal.branch_id = cliente.branch_id
GROUP BY loan_type;


/*Crear una tabla denominada “auditoria_cuenta” para guardar los datos movimientos*/
CREATE TABLE auditoria_cuenta(
			old_id INTEGER PRIMARY KEY,
			new_id INTEGER,
			old_balance INTEGER,
			new_balance INTEGER, 
			old_iban TEXT,
			new_iban TEXT,
			old_type INTEGER,
			new_type INTEGER, 
			user_action INTEGER,
			created_at INTEGER
			);

/*Crear un trigger que después de actualizar en la tabla cuentas los campos balance, IBAN o tipo de cuenta registre en la tabla auditoria*/
CREATE TRIGGER registro_auditoria
AFTER UPDATE ON cliente
WHEN OLD.balance <> NEW.balance <> OLD.iban != NEW.iban <> OLD.tipo_de_cuenta <> NEW.tipo_de_cuenta
BEGIN
	INSERT INTO auditoria_cuenta(
			old_id,
			new_id,
			old_balance,
			new_balance, 
			old_iban,
			new_iban,
			old_type,
			new_type, 
			user_action,
			created_at
	)
VALUES 
	(	old.id,
		new.id,
		old.balance,
		new.balance, 
		old.iban,
		new.iban,
		old.type,
		new.type, 
		'UPDATE',
		DATETIME('NOW')
	);
END;

/* Restar $100 a las cuentas 10,11,12,13,14*/
UPDATE cuenta
SET balance = balance - 100
WHERE account_id >= 10 AND account_id <= 14; /*Asi para las distintas cuentas*/

/*Mediante índices mejorar la performance la búsqueda de clientes por DNI*/
CREATE UNIQUE INDEX clientes_x_dni
ON cliente (customer_DNI); /*ver*/

/*Crear la tabla “movimientos” con los campos de identificación del movimiento, número de cuenta, monto, tipo de operación y hora*/
CREATE TABLE movimientos (
			movimiento INTEGER NOT NULL PRIMARY KEY,
			nro_cuenta INTEGER NOT NULL, 
			flag TEXT NOT NULL,
			monto INTEGER NOT NULL,
			tipo_operacion INTEGER NOT NULL DEFAULT 'Transaccion',
			hora TIME NOT NULL
			);

/*Funciona si se borra todo lo que está arriba*/			
/*Mediante el uso de transacciones, hacer una transferencia de 1000$ desde la cuenta 200 a la cuenta 400*/
/*Registrar el movimiento en la tabla movimientos*/
BEGIN; --Selecciono desde BEGIN...

UPDATE cuenta
   SET balance = balance - 1000
 WHERE account_id = 200;

UPDATE cuenta
   SET balance = balance + 1000
 WHERE account_id = 400;
 
INSERT INTO movimientos (nro_cuenta,flag,monto, hora) 
VALUES(200,'-',1000,datetime('now'));

INSERT INTO movimientos (nro_cuenta,flag,monto,hora) 
VALUES(400,'+',1000,datetime('now'));
/*...Hasta aca para correr la instruccion y realizar la transaccion y luego selecciono unicamente ROLLBACK o COMMIT dependiendo
de lo que quiera hacer*/

ROLLBACK;--Selecciono solo ROLLBACK y corro la instrucción si deseo deshacer los cambios

COMMIT; --Selecciono solo COMMIT y corro la instrucción si deseo realizar los cambios 

/*Consulto el balance de la cuenta y si es mayor a 0 realizo un COMMIT*/
/*Si es menor que 0 realizo un ROLLBACK ya que no es posible realizar la transaccion (Por poner un ejemplo)*/
SELECT *
FROM cuenta
WHERE account_id = 200;

SELECT * 
FROM movimientos;